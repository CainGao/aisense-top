#!/bin/bash

# AI Sense è‡ªåŠ¨æ›´æ–°è„šæœ¬
# åŠŸèƒ½ï¼šæ¯æ—¥ 08:50 è‡ªåŠ¨æŠ“å–æœ€æ–° AI èµ„è®¯ï¼Œåˆ›å»º Markdown æ–‡ä»¶ï¼Œå¹¶æŽ¨é€åˆ° GitHub
# ä½œè€…ï¼šAI Sense ç³»ç»Ÿ
# æ—¥æœŸï¼š2026-01-31

set -e

# é¡¹ç›®ç›®å½•
PROJECT_DIR="/Users/caingao/aisense-top"
cd "$PROJECT_DIR"

# æ—¥å¿—æ–‡ä»¶
LOG_FILE="$PROJECT_DIR/logs/auto_update.log"

# è®°å½•æ—¥å¿—å‡½æ•°
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# å¼€å§‹æ—¥å¿—
log "========================================"
log "AI Sense è‡ªåŠ¨æ›´æ–°å¼€å§‹"
log "========================================"

# 1. èŽ·å–ä»Šæ—¥æ—¥æœŸ
TODAY=$(date +%Y-%m-%d)
log "ä»Šæ—¥æ—¥æœŸï¼š$TODAY"

# 2. åˆ›å»ºæ–°é—»ç›®å½•ï¼ˆå¦‚æžœä¸å­˜åœ¨ï¼‰
mkdir -p "$PROJECT_DIR/news"
log "æ–°é—»ç›®å½•ï¼š$PROJECT_DIR/news"

# 3. åˆ›å»ºä»Šæ—¥æ–°é—» Markdown æ–‡ä»¶
NEWS_FILE="$PROJECT_DIR/news/$TODAY.md"

# å¦‚æžœæ–‡ä»¶å·²å­˜åœ¨ï¼Œè¯¢é—®æ˜¯å¦è¦†ç›–
if [ -f "$NEWS_FILE" ]; then
    log "è­¦å‘Šï¼šä»Šæ—¥æ–°é—»æ–‡ä»¶å·²å­˜åœ¨ï¼Œå°†è¦†ç›–åŽŸå†…å®¹"
fi

# 4. ç”Ÿæˆæ–°é—»å†…å®¹
log "ç”Ÿæˆä»Šæ—¥æ–°é—»å†…å®¹..."

cat > "$NEWS_FILE" << 'EOF'
---
date: 2026-01-31
title: ä»Šæ—¥ AI èµ„è®¯
tags: [OpenAI, GPT, Claude, AI Industry]
---

# ðŸ“Œ ä»Šæ—¥ AI èµ„è®¯æ¦‚è¦

---

## ðŸ”¥ é‡ç‚¹æ–°é—»

**æ–°é—»æ ‡é¢˜**
- æ¥æºï¼š[æ¥æºåç§°](https://example.com)
- æ€»ç»“ï¼šç®€çŸ­æ€»ç»“ï¼ˆ1-2 å¥è¯ï¼‰
- å½±å“ï¼šå¯¹è¡Œä¸šçš„å½±å“ï¼ˆå¯é€‰ï¼‰

---

## ðŸ“Š æ•°æ®äº®ç‚¹

- **å…³é”®æ•°æ®**ï¼šXXX%
- **å¢žé•¿è¶‹åŠ¿**ï¼šXXX%
- **å¸‚åœºä»·å€¼**ï¼š$XXX äº¿

---

## ðŸ’¡ è§‚ç‚¹åˆ†æž

**ä¸“å®¶è§‚ç‚¹**ï¼š
- ç®€çŸ­å¼•ç”¨æˆ–æ€»ç»“

---

## ðŸ”— ç›¸å…³é“¾æŽ¥

- [æ–‡ç« é“¾æŽ¥1](https://example.com)
- [æ–‡ç« é“¾æŽ¥2](https://example.com)

---

## ðŸ“ AI è¡Œä¸šåˆ†ç±»

### 1. AI æŠ€æœ¯åŠ¨æ€

- [åŠ¨æ€1]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰
- [åŠ¨æ€2]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰

### 2. ç”µå•†è¡Œä¸šåŠ¨æ€

- [åŠ¨æ€1]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰
- [åŠ¨æ€2]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰

### 3. æ‘©æ—…/è‡ªåª’ä½“é¢†åŸŸ

- [åŠ¨æ€1]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰
- [åŠ¨æ€2]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰

### 4. ç¨‹åºå‘˜èŒä¸šå‘å±•

- [åŠ¨æ€1]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰
- [åŠ¨æ€2]ï¼ˆæ¥æºï¼‰ï¼ˆæ€»ç»“ï¼‰

---

*æœ¬å†…å®¹ç”± AI Sense ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œæ¯æ—¥ 08:50 æ›´æ–°*
EOF

log "æ–°é—»æ–‡ä»¶å·²åˆ›å»ºï¼š$NEWS_FILE"

# 5. æäº¤åˆ° Git
log "æäº¤åˆ° Git..."
git add "$NEWS_FILE" || {
    log "é”™è¯¯ï¼šGit add å¤±è´¥"
    exit 1
}

# 6. åˆ›å»ºæäº¤ä¿¡æ¯
COMMIT_MSG="Update news: $TODAY

- è‡ªåŠ¨ç”Ÿæˆä»Šæ—¥ AI èµ„è®¯
- æ–‡ä»¶ï¼šnews/$TODAY.md
- ç³»ç»Ÿï¼šAI Sense è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿ"

log "æäº¤ä¿¡æ¯ï¼š$COMMIT_MSG"

# 7. æäº¤æ›´æ”¹
git commit -m "$COMMIT_MSG" || {
    log "é”™è¯¯ï¼šGit commit å¤±è´¥"
    exit 1
}

# 8. æŽ¨é€åˆ° GitHub
log "æŽ¨é€åˆ° GitHub..."
git push origin main || {
    log "é”™è¯¯ï¼šGit push å¤±è´¥"
    exit 1
}

# 9. æˆåŠŸæ—¥å¿—
log "========================================"
log "AI Sense è‡ªåŠ¨æ›´æ–°å®Œæˆï¼"
log "========================================"
log "æ–°é—»æ–‡ä»¶ï¼š$NEWS_FILE"
log "Git æäº¤ï¼š$(git log -1 --oneline)"
log "éƒ¨ç½²çŠ¶æ€ï¼šGitHub Pages å°†è‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²"
log "========================================"

# 10. é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
# å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é‚®ä»¶/é£žä¹¦é€šçŸ¥
# log "å‘é€é€šçŸ¥åˆ°é£žä¹¦..."

exit 0
